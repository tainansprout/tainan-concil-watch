(window.webpackJsonp=window.webpackJsonp||[]).push([[3,16,23],{379:function(t,e,n){"use strict";n.d(e,"e",(function(){return f})),n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return m})),n.d(e,"d",(function(){return v})),n.d(e,"c",(function(){return _}));n(13),n(34),n(133),n(249),n(250),n(53),n(81),n(65),n(83),n(35),n(163),n(82);var r=n(380),o=n.n(r),d=n(101),c=n(381),l=c.a.reduce((function(t,e){return t[e.abbr||e.name]=e,t}),{});function f(t){var e=t.join(".");return e.endsWith("區")||(e+="區"),e}function h(t){if(t){if(t.name&&t.avatar)return t;var e=l[t];if(e||(e=c.a.find((function(p){var e=(p.alias||[]).includes(t);return p.name===t||e}))),!e)throw new Error("Undefined party: ".concat(t));return e}}function m(t){return o()(t).format("YYYY.MM.DD")}function v(t){if(t){var e=t.offsetTop-d.e;setTimeout((function(){window.scrollTo({top:e,behavior:"smooth"})}))}}function _(t){var e=/st|nd|rd|th/,n=(t=t.toString()).match(e);t=t.replace(e,"");var r=d.g[t];if(!r)throw new Error("Undefined number: ".concat(t));return n?"第".concat(r):r}},381:function(t){t.exports=JSON.parse('{"a":[{"name":"中國國民黨","abbr":"國民黨","avatar":"/content-img/party-國.png"},{"name":"民主進步黨","abbr":"民進黨","avatar":"/content-img/party-民.png"},{"name":"台灣團結聯盟","avatar":"/content-img/party-台.png"},{"name":"無黨籍","avatar":"/content-img/party-無.png"},{"name":"無黨團結聯盟","avatar":"/content-img/party-無盟.jpg"},{"name":"台灣基進","alias":["台灣基進黨"],"avatar":"/content-img/party-基.png"},{"name":"時代力量","avatar":"/content-img/party-時.png"},{"name":"新黨","avatar":"/content-img/party-新.png"},{"name":"台灣民眾黨","avatar":"/content-img/party-眾.png"},{"name":"綠黨","avatar":"/content-img/party-綠.png"}]}')},401:function(t,e,n){var content=n(432);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("4ac103e3",content,!0,{sourceMap:!1})},407:function(t,e,n){"use strict";n.r(e);n(34),n(66),n(133);var defs=n(101),r=n(379),o={props:{councilorMap:{type:Object,required:!0},sayit:{type:Object,required:!0}},computed:{councilor:function(){return this.councilorMap[this.sayit.councilorId]},district:function(){return"".concat(this.councilor.districtTitle," | ").concat(this.councilor.townList.join("."))},roundLabel:function(){var t=Object(r.c)(this.sayit.councilorRound||defs.b),e=Object(r.c)(this.sayit.round);return"".concat(t,"屆第").concat(e,"次").concat(this.sayit.type)},canViewPdf:function(){return!!this.sayit.src[0]}},methods:{gotoPdf:function(){this.canViewPdf&&this.$refs.srcViewer.show()}}},d=(n(598),n(27)),component=Object(d.a)(o,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"intCard",class:{pointer:t.canViewPdf},on:{click:t.gotoPdf}},[e("div",{staticClass:"intCard__meta flex-ns flex-row-reverse justify-between ls3"},[e("div",{staticClass:"f6 gray"},[t._v(t._s(t.sayit.date))]),e("div",{staticClass:"mt3 mt0-ns"},[e("div",{staticClass:"f6 gray mb1"},[t._v("質詢議員： "+t._s(t.councilor.name))]),e("div",{staticClass:"f6 gray"},[t._v("選舉區域： "+t._s(t.district))])])]),e("h2",{staticClass:"f4 f3-ns fw5 ls4"},[t._v(t._s(t.sayit.summary))]),e("p",{staticClass:"ls2"},[t._v(t._s(t.sayit.say)+"...")]),t.sayit.editorNote?e("p",{staticClass:"ls2 f6 gray"},[t._v("新芽補充： "+t._s(t.sayit.editorNote))]):t._e(),e("button",{staticClass:"intCard__src plainButton flex justify-between w-100",on:{click:function(e){return e.stopPropagation(),t.gotoPdf.apply(null,arguments)}}},[e("div",{staticClass:"flex items-center f6 ls1"},[e("span",[t._v("來源出處：")]),e("div",{staticClass:"intCard__round"},[t._v(t._s(t.roundLabel))])]),t.canViewPdf?e("div",{staticClass:"flex items-center ls2 dn"},[e("div",{staticClass:"intCard__more underline dn db-ns"},[t._v("閱讀更多")]),e("tcw-icon",{staticClass:"intCard__moreIcon dn db-ns ml2",attrs:{icon:"chevron-right-black"}}),e("tcw-icon",{staticClass:"intCard__moreIcon db dn-ns ml2",attrs:{icon:"chevron-right-blue"}})],1):t._e()])]),t.canViewPdf?e("interpellation-src-viewer",{ref:"srcViewer",attrs:{"start-page":t.sayit.src[0],"councilor-round":t.sayit.councilorRound,"meeting-round":t.sayit.round,highlight:t.sayit.say}}):t._e()],1)}),[],!1,null,"e48ba6ba",null);e.default=component.exports;installComponents(component,{TcwIcon:n(251).default,InterpellationSrcViewer:n(509).default})},430:function(t,e,n){var content=n(465);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("71b95d58",content,!0,{sourceMap:!1})},431:function(t,e,n){"use strict";n(401)},432:function(t,e,n){var r=n(32)(!1);r.push([t.i,".sip[data-v-4dc5e1d9] .pdfViewer .page{box-sizing:content-box}",""]),t.exports=r},443:function(t,e,n){"use strict";n.r(e);n(391);var r={props:{document:{type:Object,required:!0},page:{type:Number,required:!0},highlight:{type:String,default:""},noScroll:{type:Boolean,default:!0}},mounted:function(){this.renderPdf()},methods:{renderPdf:function(){var t=this,e=window.pdfjsViewer,n=new e.EventBus,r={container:this.$refs.page.parentElement,viewer:this.$refs.page,eventBus:n};r.linkService=new e.PDFLinkService({eventBus:n}),this.highlight&&(r.findController=new e.PDFFindController({eventBus:n,linkService:r.linkService}));var o=new e.PDFSinglePageViewer(r);r.linkService.setViewer(o),n.on("pagesinit",(function(){if(o._setScale(.95,t.noScroll),t.highlight)n.dispatch("find",{type:"",query:t.highlight,phraseSearch:!0,highlightAll:!0});else{var e=o.container.parentElement.scrollTop;o.currentPageNumber=t.page,o.container.parentElement.scrollTo({top:e})}t.$emit("loaded")})),n.on("updatetextlayermatches",(function(){o.currentPageNumber!==t.page&&o._setCurrentPageNumber(t.page,!t.noScroll)})),o.setDocument(this.document),r.linkService.setDocument(this.document,null)}}},o=(n(431),n(27)),component=Object(o.a)(r,(function(){return(0,this._self._c)("div",{ref:"page",staticClass:"sip pdfViewer"})}),[],!1,null,"4dc5e1d9",null);e.default=component.exports},464:function(t,e,n){"use strict";n(430)},465:function(t,e,n){var r=n(32)(!1);r.push([t.i,".intViewer[data-v-1bbfa970]{position:fixed;left:0;right:0;top:0;bottom:0;z-index:1000;padding:2rem 0;overflow:auto;background:rgba(0,0,0,.66667)}@media screen and (min-width:60em){.intViewer[data-v-1bbfa970]{padding:2rem}}.intViewer__container[data-v-1bbfa970]{position:absolute;width:100vw;max-width:62rem;transform:translateX(-50%);left:50%;top:2rem;padding-bottom:2rem}.intViewer__close[data-v-1bbfa970]{position:sticky;top:0;z-index:1;padding:0 1rem}.intViewer__close button[data-v-1bbfa970]{color:#999;padding:1rem}.intViewer .sip+.sip[data-v-1bbfa970]{margin-top:2rem}",""]),t.exports=r},499:function(t,e,n){var content=n(599);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(33).default)("becb7b2a",content,!0,{sourceMap:!1})},509:function(t,e,n){"use strict";n.r(e);var r=n(12),o=(n(67),n(391),n(500),n(66),n(35),n(258),n(57),n(65),n(427)),d=n.n(o),defs=n(101),c="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.14.305",l={components:{InfiniteLoading:d.a},props:{startPage:{type:Number,required:!0},councilorRound:{type:String,default:defs.b},meetingRound:{type:Number,default:1},meetingType:{type:String,default:"regular"},highlight:{type:String,default:""}},data:function(){return{isLibLoaded:!1,isPageMounted:!1,isOpenedPending:!1,isOpened:!1,pdfLibTimer:null,pageChunk:{},mainPage:null,headPages:[],headLoadingState:null,tailPages:[],tailLoadingState:null}},head:function(){return{link:[{rel:"stylesheet",href:"".concat(c,"/web/pdf_viewer.css")}]}},computed:{isMainReady:function(){return this.mainPage&&this.isOpened},isRenderReady:function(){return this.isPageMounted&&this.isLibLoaded},pdfLinkBase:function(){var t="".concat(this.meetingRound).padStart(2,"0");return"".concat("https://tainansprout.github.io/tainan-council-data/interpellation/round","/").concat(this.councilorRound,"/").concat(this.meetingType,"/").concat(t)},highlightHead:function(){var head=this.highlight.split(/[，。！？]/)[0];return head.length<12&&(head=this.highlight.slice(0,12)),head}},watch:{isRenderReady:function(){this.isOpenedPending&&(this.renderMainPage(),this.isOpenedPending=!1)}},mounted:function(){this.isLibLoaded=this.checkPdfLibReadiness(),this.isPageMounted=!0},beforeDestroy:function(){clearTimeout(this.pdfLibTimer)},methods:{handlePageClick:function(t){t.target.closest(".textLayer")||this.hide()},show:function(){var t=this;this.isOpened=!0,this.isRenderReady?this.$nextTick((function(){t.renderMainPage()})):(this.isOpenedPending=!0,this.keepCheckingPdfLibRediness())},hide:function(){this.isOpened=!1,this.isOpenedPending=!1},checkPdfLibReadiness:function(){return!!window&&!!window.pdfjsLib&&!!window.pdfjsViewer},keepCheckingPdfLibRediness:function(){var t=this;this.pdfLibTimer=setTimeout((function(){t.isLibLoaded=t.checkPdfLibReadiness(),t.isLibLoaded?window.pdfjsLib.GlobalWorkerOptions.workerSrc="".concat(c,"/build/pdf.worker.js"):t.keepCheckingPdfLibRediness()}),100)},preparePdf:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,d,l,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.pdfjsLib,o="".concat(c,"/cmaps/"),d=t%10||10,l=e.getPageChunkIndex(t),e.pageChunk[l]||(e.pageChunk[l]=r.getDocument({url:"".concat(e.pdfLinkBase,"/").concat(l,".pdf"),cMapUrl:o,cMapPacked:!0,enableXfa:!0})),n.next=7,e.pageChunk[l].promise;case 7:return f=n.sent,n.abrupt("return",{document:f,page:d});case 9:case"end":return n.stop()}}),n)})))()},renderMainPage:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.preparePdf(t.startPage);case 2:n=e.sent,(r=t.highlight.split(/[，。！？]/)[0]).length<12&&(r=t.highlight.slice(0,12)),n.highlight=r,t.mainPage=n;case 7:case"end":return e.stop()}}),e)})))()},getPageChunkIndex:function(t){var e=Math.ceil(t/10);return"".concat(e).padStart(3,"0")},markLoadingDone:function(t){t&&this.tailLoadingState?(this.tailLoadingState.loaded(),this.tailLoadingState=null):!t&&this.headLoadingState&&(this.headLoadingState.loaded(),this.headLoadingState=null)},loadMore:function(t,e){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o,d,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=n.startPage,t?o+=n.tailPages.length+1:o=o-n.headPages.length-1,r.next=4,n.preparePdf(o);case 4:d=r.sent,c={id:o,pdf:d},setTimeout((function(){t?(n.tailPages.push(c),n.tailLoadingState=e):(n.headPages.unshift(c),n.headLoadingState=e)}),300);case 7:case"end":return r.stop()}}),r)})))()}}},f=(n(464),n(27)),component=Object(f.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"intViewer",class:{db:t.isOpened,dn:!t.isOpened},on:{click:t.hide}},[e("b-loading",{attrs:{"is-full-page":!0,active:!t.isMainReady}}),t.isMainReady?e("div",{staticClass:"intViewer__container"},[e("div",{staticClass:"intViewer__close flex justify-end"},[e("button",{staticClass:"plainButton f4 cursor",on:{click:t.hide}},[e("i",{staticClass:"fas fa-times-circle"})])]),e("client-only",[t.mainPage?e("infinite-loading",{attrs:{distance:0,direction:"top"},on:{infinite:function(e){return t.loadMore(!1,e)}}},[e("div",{attrs:{slot:"no-more"},slot:"no-more"}),e("div",{attrs:{slot:"no-results"},slot:"no-results"})]):t._e()],1),e("div",{staticClass:"h3"}),t._l(t.headPages,(function(n){return e("single-interpellation-pdf",t._b({key:n.id,on:{loaded:function(e){return t.markLoadingDone(!1)}},nativeOn:{click:function(e){return e.stopPropagation(),t.handlePageClick.apply(null,arguments)}}},"single-interpellation-pdf",n.pdf,!1))})),e("single-interpellation-pdf",t._b({attrs:{"no-scroll":!1},nativeOn:{click:function(e){return e.stopPropagation(),t.handlePageClick.apply(null,arguments)}}},"single-interpellation-pdf",t.mainPage,!1)),t._l(t.tailPages,(function(n){return e("single-interpellation-pdf",t._b({key:n.id,on:{loaded:function(e){return t.markLoadingDone(!0)}},nativeOn:{click:function(e){return e.stopPropagation(),t.handlePageClick.apply(null,arguments)}}},"single-interpellation-pdf",n.pdf,!1))})),e("div",{staticClass:"h3"}),e("client-only",[t.mainPage?e("infinite-loading",{attrs:{distance:0},on:{infinite:function(e){return t.loadMore(!0,e)}}},[e("div",{attrs:{slot:"no-more"},slot:"no-more"}),e("div",{attrs:{slot:"no-results"},slot:"no-results"})]):t._e()],1),e("div",{staticClass:"h3"})],2):t._e()],1)}),[],!1,null,"1bbfa970",null);e.default=component.exports;installComponents(component,{SingleInterpellationPdf:n(443).default})},598:function(t,e,n){"use strict";n(499)},599:function(t,e,n){var r=n(32)(!1);r.push([t.i,".intCard[data-v-e48ba6ba]{border-bottom:1px solid #979797;padding-bottom:1.25rem;margin-bottom:1.25rem}.intCard__meta[data-v-e48ba6ba]{margin-bottom:.75rem}.intCard__round[data-v-e48ba6ba]{color:#49b0d5;text-decoration:underline;-webkit-text-decoration-color:#49b0d5;text-decoration-color:#49b0d5}.intCard p[data-v-e48ba6ba]{margin:.75rem 0}.intCard p[data-v-e48ba6ba]:last-of-type{margin-bottom:1.25rem}@media screen and (min-width:30em){.intCard[data-v-e48ba6ba]{padding-bottom:4rem;margin-bottom:4rem}.intCard__meta[data-v-e48ba6ba]{margin-bottom:1.25rem}.intCard__round[data-v-e48ba6ba]{color:#00000f;text-decoration:none}.intCard p[data-v-e48ba6ba]{margin:1rem 0}.intCard p[data-v-e48ba6ba]:last-of-type{margin-bottom:2.25rem}.intCard:hover .intCard__src .intCard__more[data-v-e48ba6ba]{color:#49b0d5;-webkit-text-decoration-color:#49b0d5;text-decoration-color:#49b0d5}.intCard:hover .intCard__src .intCard__moreIcon.db-ns[data-v-e48ba6ba]{display:none}.intCard:hover .intCard__src .intCard__moreIcon.dn-ns[data-v-e48ba6ba]{display:block}}",""]),t.exports=r}}]);