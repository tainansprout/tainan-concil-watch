{"version":3,"sources":["webpack:///./components/SingleInterpellationPdf.vue?a1ba","webpack:///./components/InterpellationSrcViewer.vue?c041","webpack:///./components/SingleInterpellationPdf.vue?d709","webpack:///./components/SingleInterpellationPdf.vue?c3e0","webpack:///./components/SingleInterpellationPdf.vue?1a3e","webpack:///./components/SingleInterpellationPdf.vue?6699","webpack:///./components/SingleInterpellationPdf.vue","webpack:///./components/SingleInterpellationPdf.vue?13e5","webpack:///./components/InterpellationSrcViewer.vue?e390","webpack:///./components/InterpellationSrcViewer.vue?99de","webpack:///./components/InterpellationSrcViewer.vue?82ce","webpack:///./components/InterpellationSrcViewer.vue","webpack:///./components/InterpellationSrcViewer.vue?e318","webpack:///./components/InterpellationSrcViewer.vue?d37f"],"names":["content","__esModule","default","module","i","locals","exports","add","___CSS_LOADER_EXPORT___","___CSS_LOADER_API_IMPORT___","push","props","document","type","Object","required","page","Number","highlight","String","noScroll","Boolean","mounted","this","renderPdf","methods","pdfjsViewer","window","eventBus","EventBus","viewerConfig","container","$refs","parentElement","viewer","linkService","PDFLinkService","findController","PDFFindController","pdfSinglePageViewer","PDFSinglePageViewer","setViewer","on","_setScale","dispatch","query","phraseSearch","highlightAll","_setCurrentPageNumber","$emit","currentPageNumber","setDocument","component","_h","$createElement","_self","_c","ref","staticClass","PDFJS_BASE","components","InfiniteLoading","startPage","councilorRound","meetingRound","meetingType","data","isLibLoaded","isPageMounted","isOpenedPending","isOpened","pdfLibTimer","pageChunk","mainPage","headPages","headLoadingState","tailPages","tailLoadingState","head","once","skip","link","rel","href","script","hid","src","callback","initPdfLibSetting","computed","isRenderReady","pdfLinkBase","meetingRoundStr","padStart","highlightHead","split","length","slice","watch","renderMainPage","checkPdfLibReadiness","beforeDestroy","clearTimeout","pdfjsLib","GlobalWorkerOptions","workerSrc","handlePageClick","e","target","closest","hide","show","$nextTick","keepCheckingPdfLibRediness","setTimeout","preparePdf","pageIndex","CMAP_URL","pageOffset","chunkIndex","getPageChunkIndex","getDocument","url","cMapUrl","cMapPacked","enableXfa","promise","pdfDocument","pdf","Math","ceil","markLoadingDone","isTail","loaded","loadMore","$state","nextPage","id","unshift","_vm","class","db","dn","attrs","$event","slot","_e","_l","_b","key","nativeOn","stopPropagation","apply","arguments","installComponents","SingleInterpellationPdf"],"mappings":"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","file":"f093216.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SingleInterpellationPdf.vue?vue&type=style&index=0&id=7ed7fb02&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"83b0c7d8\", content, true, {\"sourceMap\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterpellationSrcViewer.vue?vue&type=style&index=0&id=3df0b46d&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"15e8b950\", content, true, {\"sourceMap\":false});","export * from \"-!../node_modules/vue-style-loader/index.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SingleInterpellationPdf.vue?vue&type=style&index=0&id=7ed7fb02&lang=scss&scoped=true&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".sip[data-v-7ed7fb02]  .pdfViewer .page{box-sizing:content-box}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"page\",staticClass:\"sip pdfViewer\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SingleInterpellationPdf.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SingleInterpellationPdf.vue?vue&type=script&lang=js&\"","//\n//\n//\n\nconst DEFAULT_SCALE = 0.95\n\nexport default {\n  props: {\n    document: {\n      type: Object,\n      required: true\n    },\n    page: {\n      type: Number,\n      required: true\n    },\n    highlight: {\n      type: String,\n      default: ''\n    },\n    noScroll: {\n      type: Boolean,\n      default: true\n    }\n  },\n  mounted () {\n    this.renderPdf()\n  },\n  methods: {\n    renderPdf () {\n      const pdfjsViewer = window.pdfjsViewer\n\n      const eventBus = new pdfjsViewer.EventBus()\n\n      const viewerConfig = {\n        container: this.$refs.page.parentElement,\n        viewer: this.$refs.page,\n        eventBus\n      }\n\n      viewerConfig.linkService = new pdfjsViewer.PDFLinkService({\n        eventBus\n      })\n\n      if (this.highlight) {\n        viewerConfig.findController = new pdfjsViewer.PDFFindController({\n          eventBus,\n          linkService: viewerConfig.linkService\n        })\n      }\n\n      const pdfSinglePageViewer = new pdfjsViewer.PDFSinglePageViewer(viewerConfig)\n      viewerConfig.linkService.setViewer(pdfSinglePageViewer)\n\n      eventBus.on('pagesinit', () => {\n        pdfSinglePageViewer._setScale(DEFAULT_SCALE, this.noScroll)\n\n        if (this.highlight) {\n          // TODO: handle search not found\n          // console.warn('search', this.highlight)\n          eventBus.dispatch('find', {\n            type: '',\n            query: this.highlight,\n            phraseSearch: true,\n            highlightAll: true\n          })\n        } else {\n          pdfSinglePageViewer._setCurrentPageNumber(this.page, !this.noScroll)\n        }\n        this.$emit('loaded')\n      })\n\n      eventBus.on('updatetextlayermatches', () => {\n        if (pdfSinglePageViewer.currentPageNumber !== this.page) {\n          pdfSinglePageViewer._setCurrentPageNumber(this.page, !this.noScroll)\n        }\n      })\n\n      pdfSinglePageViewer.setDocument(this.document)\n      viewerConfig.linkService.setDocument(this.document, null)\n    }\n  }\n}\n","import { render, staticRenderFns } from \"./SingleInterpellationPdf.vue?vue&type=template&id=7ed7fb02&scoped=true&lang=pug&\"\nimport script from \"./SingleInterpellationPdf.vue?vue&type=script&lang=js&\"\nexport * from \"./SingleInterpellationPdf.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SingleInterpellationPdf.vue?vue&type=style&index=0&id=7ed7fb02&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7ed7fb02\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../node_modules/vue-style-loader/index.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../node_modules/sass-resources-loader/lib/loader.js??ref--7-oneOf-1-4!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterpellationSrcViewer.vue?vue&type=style&index=0&id=3df0b46d&lang=scss&scoped=true&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".intViewer[data-v-3df0b46d]{position:fixed;left:0;right:0;top:0;bottom:0;z-index:1000;padding:2rem 0;overflow:auto;background:rgba(0,0,0,.6666666667)}@media screen and (min-width:60em){.intViewer[data-v-3df0b46d]{padding:2rem}}.intViewer__container[data-v-3df0b46d]{position:absolute;width:100vw;max-width:62rem;transform:translateX(-50%);left:50%;top:2rem;padding-bottom:2rem}.intViewer__close[data-v-3df0b46d]{position:-webkit-sticky;position:sticky;top:0;z-index:1;padding:0 1rem}.intViewer__close button[data-v-3df0b46d]{color:#999;padding:1rem}.intViewer .sip+.sip[data-v-3df0b46d]{margin-top:2rem}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"intViewer\",class:{db: _vm.isOpened, dn: !_vm.isOpened},on:{\"click\":_vm.hide}},[(_vm.mainPage && _vm.isOpened)?_c('div',{staticClass:\"intViewer__container\"},[_c('div',{staticClass:\"intViewer__close flex justify-end\"},[_c('button',{staticClass:\"plainButton f4 cursor\",on:{\"click\":_vm.hide}},[_c('i',{staticClass:\"fas fa-times-circle\"})])]),_c('client-only',[(_vm.mainPage)?_c('infinite-loading',{attrs:{\"distance\":0,\"direction\":\"top\"},on:{\"infinite\":function($event){return _vm.loadMore(false, $event)}}},[_c('div',{attrs:{\"slot\":\"no-more\"},slot:\"no-more\"}),_c('div',{attrs:{\"slot\":\"no-results\"},slot:\"no-results\"})]):_vm._e()],1),_c('div',{staticClass:\"h3\"}),_vm._l((_vm.headPages),function(page){return _c('single-interpellation-pdf',_vm._b({key:page.id,on:{\"loaded\":function($event){return _vm.markLoadingDone(false)}},nativeOn:{\"click\":function($event){$event.stopPropagation();return _vm.handlePageClick.apply(null, arguments)}}},'single-interpellation-pdf',page.pdf,false))}),_c('single-interpellation-pdf',_vm._b({attrs:{\"no-scroll\":false},nativeOn:{\"click\":function($event){$event.stopPropagation();return _vm.handlePageClick.apply(null, arguments)}}},'single-interpellation-pdf',_vm.mainPage,false)),_vm._l((_vm.tailPages),function(page){return _c('single-interpellation-pdf',_vm._b({key:page.id,on:{\"loaded\":function($event){return _vm.markLoadingDone(true)}},nativeOn:{\"click\":function($event){$event.stopPropagation();return _vm.handlePageClick.apply(null, arguments)}}},'single-interpellation-pdf',page.pdf,false))}),_c('div',{staticClass:\"h3\"}),_c('client-only',[(_vm.mainPage)?_c('infinite-loading',{attrs:{\"distance\":0},on:{\"infinite\":function($event){return _vm.loadMore(true, $event)}}},[_c('div',{attrs:{\"slot\":\"no-more\"},slot:\"no-more\"}),_c('div',{attrs:{\"slot\":\"no-results\"},slot:\"no-results\"})]):_vm._e()],1),_c('div',{staticClass:\"h3\"})],2):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport InfiniteLoading from 'vue-infinite-loading'\n\nconst PDFJS_BASE = '//cdn.jsdelivr.net/npm/pdfjs-dist@2.14.305'\nconst PDF_SRC_BASE = 'https://tainansprout.github.io/tainan-council-data/interpellation/round'\nconst PAGE_PER_CHUNK = 10\nconst RENDER_SLOWLY = 300\n\nconst CHECK_PDF_LIB_SOMETIME = 100\nconst MIN_SEARCH_LEN = 12\n\nexport default {\n  components: {\n    InfiniteLoading\n  },\n  props: {\n    startPage: {\n      type: Number,\n      required: true\n    },\n    councilorRound: {\n      type: String,\n      default: '3rd'\n    },\n    meetingRound: {\n      type: Number,\n      default: 1\n    },\n    meetingType: {\n      type: String,\n      default: 'regular'\n    },\n    highlight: {\n      type: String,\n      default: ''\n    }\n  },\n  data () {\n    return {\n      isLibLoaded: false,\n      isPageMounted: false,\n      isOpenedPending: false,\n      isOpened: false,\n      pdfLibTimer: null,\n\n      pageChunk: {},\n\n      mainPage: null,\n\n      headPages: [],\n      headLoadingState: null,\n\n      tailPages: [],\n      tailLoadingState: null\n    }\n  },\n  head () {\n    const once = { skip: this.isLibLoaded, once: true }\n    return {\n      link: [{ rel: 'stylesheet', href: `${PDFJS_BASE}/web/pdf_viewer.css` }],\n      script: [\n        { hid: 'pdf-js', ...once, src: `${PDFJS_BASE}/build/pdf.js` },\n        { hid: 'pdf-viewer-js', ...once, src: `${PDFJS_BASE}/web/pdf_viewer.js`, callback: this.initPdfLibSetting }\n      ]\n    }\n  },\n  computed: {\n    isRenderReady () {\n      return this.isPageMounted && this.isLibLoaded\n    },\n    pdfLinkBase () {\n      const meetingRoundStr = `${this.meetingRound}`.padStart(2, '0')\n      return `${PDF_SRC_BASE}/${this.councilorRound}/${this.meetingType}/${meetingRoundStr}`\n    },\n    highlightHead () {\n      let head = this.highlight.split(/[，。！？]/)[0]\n      if (head.length < MIN_SEARCH_LEN) {\n        head = this.highlight.slice(0, MIN_SEARCH_LEN)\n      }\n      return head\n    }\n  },\n  watch: {\n    isRenderReady () {\n      if (this.isOpenedPending) {\n        this.renderMainPage()\n        this.isOpenedPending = false\n      }\n    }\n  },\n  mounted () {\n    this.isLibLoaded = this.checkPdfLibReadiness()\n    this.isPageMounted = true\n  },\n  beforeDestroy () {\n    clearTimeout(this.pdfLibTimer)\n  },\n  methods: {\n    initPdfLibSetting () {\n      this.isLibLoaded = true\n      window.pdfjsLib.GlobalWorkerOptions.workerSrc = `${PDFJS_BASE}/build/pdf.worker.js`\n    },\n    handlePageClick (e) {\n      // hide when not clicking pdf\n      if (!e.target.closest('.textLayer')) {\n        this.hide()\n      }\n    },\n    show () {\n      this.isOpened = true\n      if (!this.isRenderReady) {\n        this.isOpenedPending = true\n        // vue-meta onload trigger only once, we need to do it ourselves\n        this.keepCheckingPdfLibRediness()\n      } else {\n        this.$nextTick(() => {\n          this.renderMainPage()\n        })\n      }\n    },\n    hide () {\n      this.isOpened = false\n      this.isOpenedPending = false\n    },\n    checkPdfLibReadiness () {\n      return !!window && !!window.pdfjsLib && !!window.pdfjsViewer\n    },\n    keepCheckingPdfLibRediness () {\n      this.pdfLibTimer = setTimeout(() => {\n        this.isLibLoaded = this.checkPdfLibReadiness()\n        if (!this.isLibLoaded) {\n          this.keepCheckingPdfLibRediness()\n        }\n      }, CHECK_PDF_LIB_SOMETIME)\n    },\n    async preparePdf (pageIndex) {\n      const pdfjsLib = window.pdfjsLib\n      const CMAP_URL = `${PDFJS_BASE}/cmaps/`\n\n      const pageOffset = pageIndex % PAGE_PER_CHUNK || PAGE_PER_CHUNK\n      const chunkIndex = this.getPageChunkIndex(pageIndex)\n\n      if (!this.pageChunk[chunkIndex]) {\n        this.pageChunk[chunkIndex] = pdfjsLib.getDocument({\n          url: `${this.pdfLinkBase}/${chunkIndex}.pdf`,\n          cMapUrl: CMAP_URL,\n          cMapPacked: true,\n          enableXfa: true\n        })\n      }\n\n      const pdfDocument = await this.pageChunk[chunkIndex].promise\n\n      return {\n        document: pdfDocument,\n        page: pageOffset\n      }\n    },\n    async renderMainPage () {\n      const pdf = await this.preparePdf(this.startPage)\n      let highlightHead = this.highlight.split(/[，。！？]/)[0]\n      if (highlightHead.length < MIN_SEARCH_LEN) {\n        highlightHead = this.highlight.slice(0, MIN_SEARCH_LEN)\n      }\n      pdf.highlight = highlightHead\n      this.mainPage = pdf\n    },\n    getPageChunkIndex (pageIndex) {\n      //  1 -> return 001\n      // 10 -> return 001\n      // 11 -> return 002\n      const chunkIndex = Math.ceil(pageIndex / PAGE_PER_CHUNK)\n      return `${chunkIndex}`.padStart(3, '0')\n    },\n    markLoadingDone (isTail) {\n      if (isTail && this.tailLoadingState) {\n        // TODO: handle end of pdf properly\n        this.tailLoadingState.loaded()\n        this.tailLoadingState = null\n      } else if (!isTail && this.headLoadingState) {\n        this.headLoadingState.loaded()\n        this.headLoadingState = null\n      }\n    },\n    async loadMore (isTail, $state) {\n      let nextPage = this.startPage\n      if (isTail) {\n        nextPage += this.tailPages.length + 1\n      } else {\n        nextPage = nextPage - this.headPages.length - 1\n      }\n      const pdf = await this.preparePdf(nextPage)\n      const page = {\n        id: nextPage,\n        pdf\n      }\n      setTimeout(() => {\n        if (isTail) {\n          this.tailPages.push(page)\n          this.tailLoadingState = $state\n        } else {\n          this.headPages.unshift(page)\n          this.headLoadingState = $state\n        }\n      }, RENDER_SLOWLY)\n    }\n  }\n}\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterpellationSrcViewer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterpellationSrcViewer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./InterpellationSrcViewer.vue?vue&type=template&id=3df0b46d&scoped=true&lang=pug&\"\nimport script from \"./InterpellationSrcViewer.vue?vue&type=script&lang=js&\"\nexport * from \"./InterpellationSrcViewer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./InterpellationSrcViewer.vue?vue&type=style&index=0&id=3df0b46d&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3df0b46d\",\n  null\n  \n)\n\nexport default component.exports\n\n/* nuxt-component-imports */\ninstallComponents(component, {SingleInterpellationPdf: require('/home/runner/work/tainan-council-watch/tainan-council-watch/tcw-ui/components/SingleInterpellationPdf.vue').default})\n"],"sourceRoot":""}