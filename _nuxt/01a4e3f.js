(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{395:function(e,t,n){var content=n(426);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(33).default)("44d1aa98",content,!0,{sourceMap:!1})},424:function(e,t,n){var content=n(459);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(33).default)("2cf11284",content,!0,{sourceMap:!1})},425:function(e,t,n){"use strict";n(395)},426:function(e,t,n){var r=n(32)(!1);r.push([e.i,".sip[data-v-4dc5e1d9]  .pdfViewer .page{box-sizing:content-box}",""]),e.exports=r},437:function(e,t,n){"use strict";n.r(t);n(385);var r={props:{document:{type:Object,required:!0},page:{type:Number,required:!0},highlight:{type:String,default:""},noScroll:{type:Boolean,default:!0}},mounted:function(){this.renderPdf()},methods:{renderPdf:function(){var e=this,t=window.pdfjsViewer,n=new t.EventBus,r={container:this.$refs.page.parentElement,viewer:this.$refs.page,eventBus:n};r.linkService=new t.PDFLinkService({eventBus:n}),this.highlight&&(r.findController=new t.PDFFindController({eventBus:n,linkService:r.linkService}));var o=new t.PDFSinglePageViewer(r);r.linkService.setViewer(o),n.on("pagesinit",(function(){if(o._setScale(.95,e.noScroll),e.highlight)n.dispatch("find",{type:"",query:e.highlight,phraseSearch:!0,highlightAll:!0});else{var t=o.container.parentElement.scrollTop;o.currentPageNumber=e.page,o.container.parentElement.scrollTo({top:t})}e.$emit("loaded")})),n.on("updatetextlayermatches",(function(){o.currentPageNumber!==e.page&&o._setCurrentPageNumber(e.page,!e.noScroll)})),o.setDocument(this.document),r.linkService.setDocument(this.document,null)}}},o=(n(425),n(27)),component=Object(o.a)(r,(function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"page",staticClass:"sip pdfViewer"})}),[],!1,null,"4dc5e1d9",null);t.default=component.exports},458:function(e,t,n){"use strict";n(424)},459:function(e,t,n){var r=n(32)(!1);r.push([e.i,".intViewer[data-v-2952509c]{position:fixed;left:0;right:0;top:0;bottom:0;z-index:1000;padding:2rem 0;overflow:auto;background:rgba(0,0,0,.6666666667)}@media screen and (min-width:60em){.intViewer[data-v-2952509c]{padding:2rem}}.intViewer__container[data-v-2952509c]{position:absolute;width:100vw;max-width:62rem;transform:translateX(-50%);left:50%;top:2rem;padding-bottom:2rem}.intViewer__close[data-v-2952509c]{position:-webkit-sticky;position:sticky;top:0;z-index:1;padding:0 1rem}.intViewer__close button[data-v-2952509c]{color:#999;padding:1rem}.intViewer .sip+.sip[data-v-2952509c]{margin-top:2rem}",""]),e.exports=r},503:function(e,t,n){"use strict";n.r(t);var r=n(12),o=(n(65),n(385),n(494),n(66),n(35),n(162),n(55),n(64),n(421)),d="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.14.305",l={components:{InfiniteLoading:n.n(o).a},props:{startPage:{type:Number,required:!0},councilorRound:{type:String,default:"3rd"},meetingRound:{type:Number,default:1},meetingType:{type:String,default:"regular"},highlight:{type:String,default:""}},data:function(){return{isLibLoaded:!1,isPageMounted:!1,isOpenedPending:!1,isOpened:!1,pdfLibTimer:null,pageChunk:{},mainPage:null,headPages:[],headLoadingState:null,tailPages:[],tailLoadingState:null}},head:function(){return{link:[{rel:"stylesheet",href:"".concat(d,"/web/pdf_viewer.css")}]}},computed:{isMainReady:function(){return this.mainPage&&this.isOpened},isRenderReady:function(){return this.isPageMounted&&this.isLibLoaded},pdfLinkBase:function(){var e="".concat(this.meetingRound).padStart(2,"0");return"".concat("https://tainansprout.github.io/tainan-council-data/interpellation/round","/").concat(this.councilorRound,"/").concat(this.meetingType,"/").concat(e)},highlightHead:function(){var head=this.highlight.split(/[，。！？]/)[0];return head.length<12&&(head=this.highlight.slice(0,12)),head}},watch:{isRenderReady:function(){this.isOpenedPending&&(this.renderMainPage(),this.isOpenedPending=!1)}},mounted:function(){this.isLibLoaded=this.checkPdfLibReadiness(),this.isPageMounted=!0},beforeDestroy:function(){clearTimeout(this.pdfLibTimer)},methods:{handlePageClick:function(e){e.target.closest(".textLayer")||this.hide()},show:function(){var e=this;this.isOpened=!0,this.isRenderReady?this.$nextTick((function(){e.renderMainPage()})):(this.isOpenedPending=!0,this.keepCheckingPdfLibRediness())},hide:function(){this.isOpened=!1,this.isOpenedPending=!1},checkPdfLibReadiness:function(){return!!window&&!!window.pdfjsLib&&!!window.pdfjsViewer},keepCheckingPdfLibRediness:function(){var e=this;this.pdfLibTimer=setTimeout((function(){e.isLibLoaded=e.checkPdfLibReadiness(),e.isLibLoaded?window.pdfjsLib.GlobalWorkerOptions.workerSrc="".concat(d,"/build/pdf.worker.js"):e.keepCheckingPdfLibRediness()}),100)},preparePdf:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,l,c,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=window.pdfjsLib,o="".concat(d,"/cmaps/"),l=e%10||10,c=t.getPageChunkIndex(e),t.pageChunk[c]||(t.pageChunk[c]=r.getDocument({url:"".concat(t.pdfLinkBase,"/").concat(c,".pdf"),cMapUrl:o,cMapPacked:!0,enableXfa:!0})),n.next=7,t.pageChunk[c].promise;case 7:return h=n.sent,n.abrupt("return",{document:h,page:l});case 9:case"end":return n.stop()}}),n)})))()},renderMainPage:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.preparePdf(e.startPage);case 2:n=t.sent,(r=e.highlight.split(/[，。！？]/)[0]).length<12&&(r=e.highlight.slice(0,12)),n.highlight=r,e.mainPage=n;case 7:case"end":return t.stop()}}),t)})))()},getPageChunkIndex:function(e){var t=Math.ceil(e/10);return"".concat(t).padStart(3,"0")},markLoadingDone:function(e){e&&this.tailLoadingState?(this.tailLoadingState.loaded(),this.tailLoadingState=null):!e&&this.headLoadingState&&(this.headLoadingState.loaded(),this.headLoadingState=null)},loadMore:function(e,t){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o,d,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=n.startPage,e?o+=n.tailPages.length+1:o=o-n.headPages.length-1,r.next=4,n.preparePdf(o);case 4:d=r.sent,l={id:o,pdf:d},setTimeout((function(){e?(n.tailPages.push(l),n.tailLoadingState=t):(n.headPages.unshift(l),n.headLoadingState=t)}),300);case 7:case"end":return r.stop()}}),r)})))()}}},c=(n(458),n(27)),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"intViewer",class:{db:e.isOpened,dn:!e.isOpened},on:{click:e.hide}},[n("b-loading",{attrs:{"is-full-page":!0,active:!e.isMainReady}}),e.isMainReady?n("div",{staticClass:"intViewer__container"},[n("div",{staticClass:"intViewer__close flex justify-end"},[n("button",{staticClass:"plainButton f4 cursor",on:{click:e.hide}},[n("i",{staticClass:"fas fa-times-circle"})])]),n("client-only",[e.mainPage?n("infinite-loading",{attrs:{distance:0,direction:"top"},on:{infinite:function(t){return e.loadMore(!1,t)}}},[n("div",{attrs:{slot:"no-more"},slot:"no-more"}),n("div",{attrs:{slot:"no-results"},slot:"no-results"})]):e._e()],1),n("div",{staticClass:"h3"}),e._l(e.headPages,(function(t){return n("single-interpellation-pdf",e._b({key:t.id,on:{loaded:function(t){return e.markLoadingDone(!1)}},nativeOn:{click:function(t){return t.stopPropagation(),e.handlePageClick.apply(null,arguments)}}},"single-interpellation-pdf",t.pdf,!1))})),n("single-interpellation-pdf",e._b({attrs:{"no-scroll":!1},nativeOn:{click:function(t){return t.stopPropagation(),e.handlePageClick.apply(null,arguments)}}},"single-interpellation-pdf",e.mainPage,!1)),e._l(e.tailPages,(function(t){return n("single-interpellation-pdf",e._b({key:t.id,on:{loaded:function(t){return e.markLoadingDone(!0)}},nativeOn:{click:function(t){return t.stopPropagation(),e.handlePageClick.apply(null,arguments)}}},"single-interpellation-pdf",t.pdf,!1))})),n("div",{staticClass:"h3"}),n("client-only",[e.mainPage?n("infinite-loading",{attrs:{distance:0},on:{infinite:function(t){return e.loadMore(!0,t)}}},[n("div",{attrs:{slot:"no-more"},slot:"no-more"}),n("div",{attrs:{slot:"no-results"},slot:"no-results"})]):e._e()],1),n("div",{staticClass:"h3"})],2):e._e()],1)}),[],!1,null,"2952509c",null);t.default=component.exports;installComponents(component,{SingleInterpellationPdf:n(437).default})}}]);